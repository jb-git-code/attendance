TITLE: Semester Backdated Attendance Initialization Logic

OBJECTIVE:
Update the attendance calculation logic to correctly handle cases where the semester started before the app was installed, while the semester end date is fixed and cannot be changed.

CONTEXT:
- The semester has a fixed start date (e.g., 6 January).
- The user installs the app later (e.g., 3 February).
- Attendance tracking inside the app starts only after installation.
- To maintain accuracy, attendance data from the semester start date up to the app installation date must be estimated and initialized correctly.

PROBLEM STATEMENT:
If attendance tracking starts only from the app installation date, the attendance percentage becomes inaccurate because earlier classes are ignored. Therefore, the app must backfill attendance data for the period between the semester start date and the app installation date.

SOLUTION OVERVIEW:
When a user adds a new subject and defines its weekly class schedule, the app must ask the user for their approximate attendance percentage for that subject from the semester start date until the app installation date. Using this percentage and the weekly schedule, the app must calculate and initialize total classes and attended classes for that past period.

DETAILED LOGIC FLOW:

1. Subject Creation Trigger
- User adds a new subject.
- User selects weekly class occurrence days (e.g., Monday, Tuesday).
- User sets classes per week and other subject details.

2. Backdated Attendance Popup
- Immediately after subject creation, show a popup/modal.
- Popup question:
  "From the start of the semester until today, approximately what percentage of classes did you attend for this subject?"
- User inputs a percentage value (e.g., 50%).

3. Gap Period Calculation
- Define:
  - semesterStartDate (fixed, e.g., 6 January)
  - appInstallDate (current date or first app launch date)
- Calculate the number of weeks and days between these two dates.
- Using the selected weekly class days, calculate how many classes would have occurred during this gap period.

4. Backdated Class Computation
- totalGapClasses = number of classes that occurred between semesterStartDate and appInstallDate
- attendedGapClasses = (userEnteredPercentage / 100) Ã— totalGapClasses
- Round attendedGapClasses to the nearest integer.

5. Counter Initialization
- Set subject.totalClasses = totalGapClasses
- Set subject.attendedClasses = attendedGapClasses
- These values represent attendance before app installation.

6. Post-Initialization Behavior
- From this point onward:
  - The app functions normally.
  - New classes are added in real time.
  - Attendance marking, prediction, bunk calculator, and summaries use the initialized counters.
- The backdated data must not be recalculated again.

EDGE CASE HANDLING:
- If the app installation date equals the semester start date:
  - Skip the popup.
  - Initialize counters as zero.
- If calculated totalGapClasses is zero:
  - Skip percentage calculation.
- Prevent user from entering values below 0% or above 100%.

CONSTRAINTS:
- Semester end date is fixed and immutable.
- No internet or external API should be required.
- All calculations must work offline.
- Logic must be deterministic and testable.

EXPECTED OUTCOME:
Attendance percentage, bunk calculator, and predictions should reflect the full semester timeline, not just the post-installation period, resulting in accurate and realistic attendance tracking.